{"ast":null,"code":"var _require = require('crypto'),\n    signOneShot = _require.sign,\n    verifyOneShot = _require.verify;\n\nvar _require2 = require('../help/consts'),\n    KEYOBJECT = _require2.KEYOBJECT;\n\nvar _require3 = require('../help/runtime_support'),\n    edDSASupported = _require3.edDSASupported;\n\nvar sign = function sign(_ref, payload) {\n  var keyObject = _ref[KEYOBJECT];\n\n  if (typeof payload === 'string') {\n    payload = Buffer.from(payload);\n  }\n\n  return signOneShot(undefined, payload, keyObject);\n};\n\nvar verify = function verify(_ref2, payload, signature) {\n  var keyObject = _ref2[KEYOBJECT];\n  return verifyOneShot(undefined, payload, keyObject, signature);\n};\n\nmodule.exports = function (JWA, JWK) {\n  if (edDSASupported) {\n    JWA.sign.set('EdDSA', sign);\n    JWA.verify.set('EdDSA', verify);\n\n    JWK.OKP.sign.EdDSA = function (key) {\n      return key.private && JWK.OKP.verify.EdDSA(key);\n    };\n\n    JWK.OKP.verify.EdDSA = function (key) {\n      return (key.use === 'sig' || key.use === undefined) && key.keyObject.asymmetricKeyType.startsWith('ed');\n    };\n  }\n};","map":null,"metadata":{},"sourceType":"script"}