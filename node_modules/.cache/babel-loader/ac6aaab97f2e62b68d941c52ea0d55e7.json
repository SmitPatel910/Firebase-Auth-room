{"ast":null,"code":"/*! firebase-admin v9.11.0 */\n\"use strict\";\n/*!\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Tenant = void 0;\n\nvar validator = require(\"../utils/validator\");\n\nvar deep_copy_1 = require(\"../utils/deep-copy\");\n\nvar error_1 = require(\"../utils/error\");\n\nvar auth_config_1 = require(\"./auth-config\");\n/**\n * Tenant class that defines a Firebase Auth tenant.\n */\n\n\nvar Tenant =\n/** @class */\nfunction () {\n  /**\n   * The Tenant object constructor.\n   *\n   * @param response The server side response used to initialize the Tenant object.\n   * @constructor\n   */\n  function Tenant(response) {\n    var tenantId = Tenant.getTenantIdFromResourceName(response.name);\n\n    if (!tenantId) {\n      throw new error_1.FirebaseAuthError(error_1.AuthClientErrorCode.INTERNAL_ERROR, 'INTERNAL ASSERT FAILED: Invalid tenant response');\n    }\n\n    this.tenantId = tenantId;\n    this.displayName = response.displayName;\n\n    try {\n      this.emailSignInConfig = new auth_config_1.EmailSignInConfig(response);\n    } catch (e) {\n      // If allowPasswordSignup is undefined, it is disabled by default.\n      this.emailSignInConfig = new auth_config_1.EmailSignInConfig({\n        allowPasswordSignup: false\n      });\n    }\n\n    this.anonymousSignInEnabled = !!response.enableAnonymousUser;\n\n    if (typeof response.mfaConfig !== 'undefined') {\n      this.multiFactorConfig = new auth_config_1.MultiFactorAuthConfig(response.mfaConfig);\n    }\n\n    if (typeof response.testPhoneNumbers !== 'undefined') {\n      this.testPhoneNumbers = deep_copy_1.deepCopy(response.testPhoneNumbers || {});\n    }\n  }\n  /**\n   * Builds the corresponding server request for a TenantOptions object.\n   *\n   * @param {TenantOptions} tenantOptions The properties to convert to a server request.\n   * @param {boolean} createRequest Whether this is a create request.\n   * @return {object} The equivalent server request.\n   */\n\n\n  Tenant.buildServerRequest = function (tenantOptions, createRequest) {\n    var _a;\n\n    Tenant.validate(tenantOptions, createRequest);\n    var request = {};\n\n    if (typeof tenantOptions.emailSignInConfig !== 'undefined') {\n      request = auth_config_1.EmailSignInConfig.buildServerRequest(tenantOptions.emailSignInConfig);\n    }\n\n    if (typeof tenantOptions.displayName !== 'undefined') {\n      request.displayName = tenantOptions.displayName;\n    }\n\n    if (typeof tenantOptions.anonymousSignInEnabled !== 'undefined') {\n      request.enableAnonymousUser = tenantOptions.anonymousSignInEnabled;\n    }\n\n    if (typeof tenantOptions.multiFactorConfig !== 'undefined') {\n      request.mfaConfig = auth_config_1.MultiFactorAuthConfig.buildServerRequest(tenantOptions.multiFactorConfig);\n    }\n\n    if (typeof tenantOptions.testPhoneNumbers !== 'undefined') {\n      // null will clear existing test phone numbers. Translate to empty object.\n      request.testPhoneNumbers = (_a = tenantOptions.testPhoneNumbers) !== null && _a !== void 0 ? _a : {};\n    }\n\n    return request;\n  };\n  /**\n   * Returns the tenant ID corresponding to the resource name if available.\n   *\n   * @param {string} resourceName The server side resource name\n   * @return {?string} The tenant ID corresponding to the resource, null otherwise.\n   */\n\n\n  Tenant.getTenantIdFromResourceName = function (resourceName) {\n    // name is of form projects/project1/tenants/tenant1\n    var matchTenantRes = resourceName.match(/\\/tenants\\/(.*)$/);\n\n    if (!matchTenantRes || matchTenantRes.length < 2) {\n      return null;\n    }\n\n    return matchTenantRes[1];\n  };\n  /**\n   * Validates a tenant options object. Throws an error on failure.\n   *\n   * @param {any} request The tenant options object to validate.\n   * @param {boolean} createRequest Whether this is a create request.\n   */\n\n\n  Tenant.validate = function (request, createRequest) {\n    var validKeys = {\n      displayName: true,\n      emailSignInConfig: true,\n      anonymousSignInEnabled: true,\n      multiFactorConfig: true,\n      testPhoneNumbers: true\n    };\n    var label = createRequest ? 'CreateTenantRequest' : 'UpdateTenantRequest';\n\n    if (!validator.isNonNullObject(request)) {\n      throw new error_1.FirebaseAuthError(error_1.AuthClientErrorCode.INVALID_ARGUMENT, \"\\\"\" + label + \"\\\" must be a valid non-null object.\");\n    } // Check for unsupported top level attributes.\n\n\n    for (var key in request) {\n      if (!(key in validKeys)) {\n        throw new error_1.FirebaseAuthError(error_1.AuthClientErrorCode.INVALID_ARGUMENT, \"\\\"\" + key + \"\\\" is not a valid \" + label + \" parameter.\");\n      }\n    } // Validate displayName type if provided.\n\n\n    if (typeof request.displayName !== 'undefined' && !validator.isNonEmptyString(request.displayName)) {\n      throw new error_1.FirebaseAuthError(error_1.AuthClientErrorCode.INVALID_ARGUMENT, \"\\\"\" + label + \".displayName\\\" must be a valid non-empty string.\");\n    } // Validate emailSignInConfig type if provided.\n\n\n    if (typeof request.emailSignInConfig !== 'undefined') {\n      // This will throw an error if invalid.\n      auth_config_1.EmailSignInConfig.buildServerRequest(request.emailSignInConfig);\n    } // Validate test phone numbers if provided.\n\n\n    if (typeof request.testPhoneNumbers !== 'undefined' && request.testPhoneNumbers !== null) {\n      auth_config_1.validateTestPhoneNumbers(request.testPhoneNumbers);\n    } else if (request.testPhoneNumbers === null && createRequest) {\n      // null allowed only for update operations.\n      throw new error_1.FirebaseAuthError(error_1.AuthClientErrorCode.INVALID_ARGUMENT, \"\\\"\" + label + \".testPhoneNumbers\\\" must be a non-null object.\");\n    } // Validate multiFactorConfig type if provided.\n\n\n    if (typeof request.multiFactorConfig !== 'undefined') {\n      // This will throw an error if invalid.\n      auth_config_1.MultiFactorAuthConfig.buildServerRequest(request.multiFactorConfig);\n    }\n  };\n  /** @return {object} The plain object representation of the tenant. */\n\n\n  Tenant.prototype.toJSON = function () {\n    var _a, _b;\n\n    var json = {\n      tenantId: this.tenantId,\n      displayName: this.displayName,\n      emailSignInConfig: (_a = this.emailSignInConfig) === null || _a === void 0 ? void 0 : _a.toJSON(),\n      anonymousSignInEnabled: this.anonymousSignInEnabled,\n      multiFactorConfig: (_b = this.multiFactorConfig) === null || _b === void 0 ? void 0 : _b.toJSON(),\n      testPhoneNumbers: this.testPhoneNumbers\n    };\n\n    if (typeof json.multiFactorConfig === 'undefined') {\n      delete json.multiFactorConfig;\n    }\n\n    if (typeof json.testPhoneNumbers === 'undefined') {\n      delete json.testPhoneNumbers;\n    }\n\n    return json;\n  };\n\n  return Tenant;\n}();\n\nexports.Tenant = Tenant;","map":null,"metadata":{},"sourceType":"script"}